# gtfs-validator [![Test Package Document](https://github.com/MobilityData/gtfs-validator/workflows/Test%20Package%20Document/badge.svg)](https://github.com/MobilityData/gtfs-validator/actions?query=workflow%3A%22Test+Package+Document%22) ![End to end](https://github.com/MobilityData/gtfs-validator/workflows/End%20to%20end/badge.svg) ![End to end big](https://github.com/MobilityData/gtfs-validator/workflows/End%20to%20end%20big/badge.svg) ![End to end 100](https://github.com/MobilityData/gtfs-validator/workflows/End%20to%20end%20100/badge.svg) ![Docker image](https://github.com/MobilityData/gtfs-validator/actions/workflows/docker.yml/badge.svg) [![Join the gtfs-validator chat](https://mobilitydata-io.herokuapp.com/badge.svg)](https://mobilitydata-io.herokuapp.com/)

A GTFS Schedule (static) [General Transit Feed Specification (GTFS)](https://gtfs.mobilitydata.org/spec/gtfs-schedule) feed validator

This README contains information for master branch of this project, which is under active development. If you'd like to view documentation for past releases of the project, see:
* [v1.4.0](https://github.com/MobilityData/gtfs-validator/blob/v1.4.0/README.md)
* [v2.0.0](https://github.com/MobilityData/gtfs-validator/blob/v2.0.0/README.md)

# Introduction
This is a command-line tool written in Java that performs the following steps:
1. Loads input GTFS zip file from a URL or disk
1. Checks file integrity, numeric type parsing and ranges as well as string format according to the [GTFS Schedule specification](https://gtfs.mobilitydata.org/spec/gtfs-schedule#h.hc443y62gb8c)
1. Performs GTFS [business rule validation](/RULES.md)

# Run the app via command line
### Setup
1. Install [Java 8 or higher](https://www.oracle.com/java/technologies/javase-downloads.html)
1. Download the latest snapshot jar of the validator from the artifacts generated by the [`Test Package Document`](https://github.com/MobilityData/gtfs-validator/actions/workflows/test_pack_doc.yml) workflow.

### Run it
To validate a GTFS dataset on your computer:

`java -jar gtfs-validator-v-snapshot_cli.jar -i /myDirectory/gtfs.zip -o output -c ca` 

To download and validate a GTFS dataset from a URL:

`java -jar gtfs-validator-v-snapshot_cli.jar -u https://www.abc.com/gtfs.zip -o output -c ca`

where:
* `--input` or `-i`: the path to the GTFS file (e.g., `/myDirectory/gtfs.zip`)
* `--url` or `-u`: the fully qualified URL to the GTFS file (e.g., `https://www.abc.com/gtfs.zip`)
* `--output` or `-o`: the path where the validation report will be stored (e.g., `output`)
* *(Optional)* `--country_code` or `-c`: the country code of the feed as a valid [ISO two letter country code](https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2) (e.g., `ca`, `us`). It can be either lower or upper case (e.g. `FR` or `GP`). If `-c` is not provided or country code is unknown, phone numbers will be validated if they start by `+`.   
* *(Optional)* `--thread` or `-t`: the number of Java threads to use

More detailed instructions are on our ["Usage"](/docs/USAGE.md) page.

# Run the app using Docker
### Setup
1. Download and install [Docker](https://docs.docker.com/get-started/)
1. Pull the [latest Docker image for this project](https://github.com/orgs/MobilityData/packages/container/package/gtfs-validator). For example, `docker pull ghcr.io/mobilitydata/gtfs-validator` for the latest snapshot version of the validator.

### Run it

#### For Mac and Linux

To run the Docker image in a new container:

`docker run -v /myDirectory:/theContainerDirectory -it ghcr.io/mobilitydata/gtfs-validator:latest`

where:
* `-v /myDirectory:/theContainerDirectory`: syntax to share directories and data between the container and the host (your computer). With the above command, any files that you place in `/myDirectory` on the host will show up in `/theContainerDirectory` inside the container and vice versa.

***NOTE:*** On Windows, you must provide the local volume (e.g., `c:`) as well:

`... c:/myDirectory:/theContainerDirectory ...`

The validator can then be executed via bash commands. See the [preceeding instructions for command line usage](#run-the-app-via-command-line).

# Validation rules
* [Implemented rules](/RULES.md)
* [GTFS Reference related rules](https://github.com/MobilityData/gtfs-validator/labels/Rules%20-%20GTFS%20Reference)
* [GTFS Best Practices related rules](https://github.com/MobilityData/gtfs-validator/labels/Rules%20-%20GTFS%20Best%20Practices)
* [Common cases of bad data related rules](https://github.com/MobilityData/gtfs-validator/labels/Rules%20-%20Common%20cases%20of%20bad%20data)

Have a suggestion for a new rule? Open [an issue](https://github.com/MobilityData/gtfs-validator/issues/new/choose). You can see the complete process for adding new rules on the ["Adding new rules"](/docs/NEW_RULES.md) page.

# Build the code
We suggest using [IntelliJ](https://www.jetbrains.com/idea/download/) to [import](https://www.jetbrains.com/help/idea/import-project-or-module-wizard.html), build, and run this project.

Instructions to build the project from the command-line using [Gradle](https://gradle.org/) are available in our [Build documentation](/docs/BUILD.md).

# Architecture
The architecture of the `gtfs-validator` is described on our [Architecture page](/docs/ARCHITECTURE.md).

# License
Code licensed under the [Apache 2.0 License](http://www.apache.org/licenses/LICENSE-2.0).

# Contributing
We welcome contributions to the project! Please check out our [Contribution guidelines](/docs/CONTRIBUTING.md) for details. 
